import{X as w,Y as g,r as o,c6 as P,a6 as _,ct as S,az as x,cu as E,cv as M,cw as k,aB as y,bW as v,cs as D,b6 as R,b1 as U,an as $,cx as j}from"./sanity-5e451c36.js";function F(u){return w(function(p,t){var a=!1,r=0;p.subscribe(g(t,function(e){return(a||(a=!u(e,r++)))&&t.next(e)}))})}const I=u=>{const{comlink:p,refs:t,perspective:a}=u,r=P(),e=_(),c=o.useMemo(()=>new S,[]),d=o.useMemo(()=>c.asObservable().pipe(x(b=>E(b.map(s=>{const l={...s,_id:M(s._id)},m=a==="previewDrafts"?r.observeForPreview(l,e.get(l._type)).pipe(k(),F(i=>i.snapshot===null)):y,f={...s,_id:v(s._id)},h=r.observeForPreview(f,e.get(f._type));return D(h.pipe(R(m)),m).pipe(U(i=>!!i.snapshot),$(i=>{const n=i.snapshot;return{_id:v(n._id),title:n.title,subtitle:n.subtitle,description:n.description,imageUrl:n.imageUrl}}))}))),j(0)),[r,c,e,a]);return o.useEffect(()=>{const b=d.subscribe(s=>{p.post({type:"presentation/preview-snapshots",data:{snapshots:s}})});return()=>{b.unsubscribe()}},[p,d]),o.useEffect(()=>{c.next(t)},[t,c]),null};var W=o.memo(I);export{W as default};
